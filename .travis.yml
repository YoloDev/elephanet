language: csharp
solution: Elephanet.sln
addons:
  postgresql: "9.4"

before_script:
  - psql -c "CREATE USER store_user with PASSWORD 'my super secret password';" -U postgres
  - psql -c "CREATE DATABASE store;" -U postgres
  - psql -c "GRANT ALL PRIVILEGES ON DATABASE store to store_user;" -U postgres

script:
  - xbuild /p:Configuration=Release Elephanet.sln 
  - mono ./packages/xunit.runners.1.9.2/tools/xunit.console.clr4.exe  ./Elephanet.Tests/bin/Release/Elephanet.Tests.dll
  - cd Elephanet && nuget pack Elephanet.csproj -IncludeReferencedProjects -Prop Configuration=Release
  - nuget setApiKey NUGET_API_KEY
  - cd Elephanet && nuget push *.nupkg
